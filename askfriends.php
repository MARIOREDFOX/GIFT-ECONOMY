
<!doctype html>
<html lang="en-us" class="friend-ask_friend" >
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=Edge;chrome=1" >
	<title>Gift Circle &mdash; Ask Friends for Lists</title>
<link href="http://www.giftcircle.co.uk/favicon.ico?refr=y" rel="shortcut icon" type="image/x-icon" />
	<link type="text/css" href="/static/css/bootstrap.min.css" rel="stylesheet" media="screen" />
	<link type="text/css" href="/static/css/theme.css" rel="stylesheet" media="screen" />
	<link type="text/css" href="/static/css/print.css" rel="stylesheet" media="print" />
	<link type="text/css" href="/static/css/engage.itoggle.css" rel="stylesheet" media="screen" />
<!--[if IE 7]><link rel="stylesheet" href="/static/css/ie7styles.css" type="text/css" /><![endif]-->
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
	<script type="text/javascript" src="/static/js/cufon-yui.js"></script>
	<script type="text/javascript" src="/static/js/HouschkaAltBlackRegular_900.font.js"></script>
	<script type="text/javascript" src="/static/js/VAGLight_700.font.js"></script>
	<script type="text/javascript" src="/static/js/nevisBold_700.font.js"></script>
	<script type="text/javascript" src="/static/js/engage.itoggle.js"></script>
	<script type="text/javascript" src="/static/js/jquery.metadata.js"></script>
	<script type="text/javascript" src="/static/js/jquery.tablesorter.min.js"></script>
	<script type="text/javascript" src="/static/js/functions.js"></script>
	<script type="text/javascript" src="/static/js/test/jquery-1.11.2.min.js"></script>
	<script type="text/javascript" src="/static/js/test/bootstrap.min.js"></script>
<script type="text/javascript">
var _gaq = _gaq || [];_gaq.push(['_setAccount', 'UA-26418668-1']);_gaq.push(['_trackPageview']);(function(){var ga=document.createElement('script');ga.type='text/javascript';ga.async=true;ga.src=('https:'==document.location.protocol?'https://ssl':'http://www')+'.google-analytics.com/ga.js';var s=document.getElementsByTagName('script')[0];s.parentNode.insertBefore(ga,s);})();
</script>

<script src="//use.typekit.net/vxb6gzu.js"></script>
<script>try{Typekit.load();}catch(e){}</script>

<!-- footer -->

<script type='text/javascript'>
    function expandToWindow(container, footer) {
         var footerSize = window.innerHeight - container.offsetHeight - 138 ;
         var footerSizePX = footerSize.toString() + "px";
         footer.style.height = footerSizePX;
    }
</script>

<!-- TradeDoubler site verification 1992396 -->

<meta property="og:title" content="Giftcircle" />
<meta property="og:type" content="website" />
<meta property="og:url" content="http://home.giftcircle.co.uk/" />
<meta property="og:image" content="http://www.giftcircle.co.uk/static/img/giftcircle-logo.png" />
<meta property="og:site_name" content="giftcirle.co.uk" />
<meta property="fb:admins" content="100000216342006" />

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Welcome</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.css">
    <style type="text/css">
        body{ font: 14px sans-serif; text-align: center; }
    </style>
</head>
<style>
body  {
    background-color: rgba(255, 1, 0, 0.1);
}
</style>

	<form method="post" action="mycircle.php">
    <p>
        <a href="reset-password.php" class="btn btn-warning">Reset Your Password</a>
        <a href="logout.php" class="btn btn-danger">Sign Out of Your Account</a>
    </p>
	
	

<body onload='expandToWindow(document.getElementById("container"), document.getElementById("footer"))' onresize='expandToWindow(document.getElementById("container"), document.getElementById("footer"))'>
<div id="container">

<!-- Load Facebook SDK for JavaScript -->
<div id="fb-root"></div>
<script>
(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_GB/all.js";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));

window.fbAsyncInit = function() {
        FB.init({
          appId      : '1493544874236368',
          xfbml      : true,
          version    : 'v2.1'
        });
};
 
</script>


 
			
	<div class="container">
					<h1 class="title">Ask Friends for Lists</h1>
			
		
	</div>
</div><!-- end of header -->

<div class="container content-container">
	<div class="content">
				<div class="row">
		<div class="span12">
		<form method="post" >
	<! -- Existing friends -->
			<! -- / Existing friends -->	
	
	<! -- New friends -->
		<fieldset>
			<h3>Ask new friends</h3>
			<a class="cs_import">Ask new friends from your Address Book</a>
			<br>
			<br>
			<!--[if lt IE 10]>
			<p>
					&nbsp;&nbsp;&nbsp;&nbsp;
					&nbsp;&nbsp;&nbsp;&nbsp;
					First name
					&nbsp;&nbsp;&nbsp;&nbsp;
					&nbsp;&nbsp;&nbsp;&nbsp;
					&nbsp;&nbsp;&nbsp;&nbsp;
					&nbsp;&nbsp;&nbsp;&nbsp;
					&nbsp;&nbsp;&nbsp;&nbsp;
				&nbsp;&nbsp;&nbsp;Surname
					&nbsp;&nbsp;&nbsp;&nbsp;
					&nbsp;&nbsp;&nbsp;&nbsp;
					&nbsp;&nbsp;&nbsp;&nbsp;
					&nbsp;&nbsp;&nbsp;&nbsp;
					&nbsp;&nbsp;&nbsp;&nbsp;
				&nbsp;&nbsp;&nbsp;Email
			</p>
			<![endif]-->
			<ol class="new-friends" id="new-friends">
								<li>
					<input class="span3" type="text" id="firstname" name="firstname[]" placeholder="First name" value="" />

					<input class="span3" type="text" id="lastname" name="surname[]" placeholder="Surname" value="" />

					<input id="email" class="span6" type="text" name="email[]" placeholder="Email address" value="" />

				</li>
								<li>
					<input class="span3" type="text" id="firstname" name="firstname[]" placeholder="First name" value="" />

					<input class="span3" type="text" id="lastname" name="surname[]" placeholder="Surname" value="" />

					<input id="email" class="span6" type="text" name="email[]" placeholder="Email address" value="" />

				</li>
								<li>
					<input class="span3" type="text" id="firstname" name="firstname[]" placeholder="First name" value="" />

					<input class="span3" type="text" id="lastname" name="surname[]" placeholder="Surname" value="" />

					<input id="email" class="span6" type="text" name="email[]" placeholder="Email address" value="" />

				</li>
								<li>
					<input class="span3" type="text" id="firstname" name="firstname[]" placeholder="First name" value="" />

					<input class="span3" type="text" id="lastname" name="surname[]" placeholder="Surname" value="" />

					<input id="email" class="span6" type="text" name="email[]" placeholder="Email address" value="" />

				</li>
								<li>
					<input class="span3" type="text" id="firstname" name="firstname[]" placeholder="First name" value="" />

					<input class="span3" type="text" id="lastname" name="surname[]" placeholder="Surname" value="" />

					<input id="email" class="span6" type="text" name="email[]" placeholder="Email address" value="" />

				</li>
								<li style="list-style-type:none"><a id="add_more" href="#" onclick="return more_friends(this)">Add more</a></li>
			</ol>
		</fieldset>
	<! -- /New friends -->
	
	<! -- Facebook friends -->
	
	<!-- Send a message to facebook friends -->
	<table >
		<tr>
			<td>		
				<li style="list-style-type:none;"><img style="vertical-align:middle" src="/img/facebook.png">
			</td>
			<td >
				<a href="#" onclick="return facebook_message(this)">Can't find the correct email address? Click here to send your friends a private Facebook message</a></li> <br />
			</td>
		</tr>
		<tr>
			<!-- Search for facebook friends who are already using Gift Circle -->
			<td>
				<li style="list-style-type:none"><img style="vertical-align:middle" src="/img/facebook.png">
			</td>
			<td>
				<a href="#" onclick="return facebook_friends(this)">Click here to see which of your facebook friends are using giftcircle</a></li>
			</td>
		</tr>
	</table>
	
    <div id="result_friends"></div>

	<! -- /Facebook friends -->
	<! -- Email Templates -->
	<br/>
	<fieldset>
				<h3>Select an email message</h3>
				<select id="email-template" name="email_template">				
											<option value="default-template.txt">
							Default Template						</option>
											<option value="birthday-template.txt">
							Birthday Template						</option>
											<option value="christmas-template.txt">
							Christmas Template						</option>
									</select>	
	</fieldset>
	<fieldset>
		<div id="template_text" style="display:none">
			<textarea id="selected-template"  readonly="true" rows="10" cols="50">
			</textarea>
		</div>
	</fieldset>	
	<br/>
	<! -- /Email Templates -->
	<! -- Submit -->
	<div class="well">
		<input name="submit" type="submit" value="Ask Friends" class="btn primary" /> 
		or
		<a href="mycircle.php">Go Back</a>
	</div>
</div>
	<! -- /Submit -->
	
<!--

<div class="span4">
	<h3>Asking for Lists</h3>
	<p>On this page you can ask your friends for their wish list.</p>
</div>

-->

<!-- Cloudsponge -->
<script type='text/javascript'>
// these values will hold the owner information
var owner_email, owner_first_name, owner_last_name;
var appendInTextarea = true;  // whether to append to existing contacts in the textarea
var emailSep = ", ";  // email address separator to use in textarea

function populateTextarea(contacts, source, owner) {
	var contact, firstname, lastname, email, entry;
	var emails = [];
	var friend_ol = document.getElementById("new-friends");
	var friend_li = friend_ol.getElementsByTagName("li");
  
	// preserve the original value in the textarea
	//if (appendInTextarea && textarea.value.strip().length > 0) {
    //emails = textarea.value.split(emailSep);
	//}

	// format each email address properly
	for (var i = 0; i < contacts.length; i++) {
  		if (i > 4)
  		{
	  		more_friends(document.getElementById("add_more"))
	  	}
	  	contact = contacts[i];
	  	name = contact.fullName();
	  	firstname = contact.first_name;
	  	lastname = contact.last_name;
	  	email = contact.selectedEmail();
	  	entry = name + "<" + email +">";
	  	if (emails.indexOf(entry) < 0) {
		  	emails.push(entry);
		}
    
    var children = friend_li[i].getElementsByTagName('input');// any tag could be used here..
	
	for(var j = 0; j< children.length;j++)
		{
			if (children[j].getAttribute('id') == 'firstname') // any attribute could be used here
			{
				children[j].value = firstname;
			}
			if (children[j].getAttribute('id') == 'lastname') // any attribute could be used here
			{
				children[j].value = lastname;
			}
			if (children[j].getAttribute('id') == 'email') // any attribute could be used here
			{
				children[j].value = email;
			}
		}

  }

  // capture the owner information
  owner_email = (owner && owner.email && owner.email[0] && owner.email[0].address) || "";
  owner_first_name = (owner && owner.first_name) || "";
  owner_last_name = (owner && owner.last_name) || "";
};

// Asynchronously include the widget library.
  (function(u){
    var d=document,s='script',a=d.createElement(s),m=d.getElementsByTagName(s)[0];
    a.async=1;a.src=u;m.parentNode.insertBefore(a,m);
  })('//api.cloudsponge.com/widget/b0141a7a0510bc9f5eb50bab77d085f2fc58a10e.js');

// set any options here, for this example, we'll simply populate the contacts in the textarea above
window.csPageOptions = {
  afterSubmitContacts:populateTextarea,
  sources:["gmail", "yahoo", "windowslive", "aol", "outlook", "addressbook", "plaxo", "facebook", "iCloud"]
};


function toggle_friends(el) {
if (el.checked) {
	$('.checkbox1').each(function() { //loop through each checkbox
                //alert("Test");
                this.checked = true;  //select all checkboxes with class "checkbox1"               
				});
        }else{
            $('.checkbox1').each(function() { //loop through each checkbox
            	//alert("Test");
                this.checked = false; //deselect all checkboxes with class "checkbox1"                       
            });         
			}

}

function more_friends(el) {
	$(el).parent().before('<li>' + $(el).parent().parent().children().first().html() + '</li>');
	return false;
}

$('#email-template').change(function()
{	$('#template_text').show();
   var email_template = $(this).val();
	$.ajax({
	type: "POST",
	url: "/list/load_template/",
	data:  {template: email_template },
	cache: false,
	success: function(html) {
		$("#selected-template").html(html);
		}
	});
});


function facebook_message(el) {
	FB.ui({
  method: 'send',
  link: 'http://www.giftcircle.co.uk',
});
	
}

function facebook_friends(el) {
		/* make the API call */
			FB.api('/me/friends', function(response) {
       if(response.data) {
       		var result_holder = document.getElementById('result_friends');
            var friend_data = response.data;
            var results = '';
             $.each(response.data,function(index,friend) {
            	
            	results += '<div><img src="https://graph.facebook.com/' + friend.id + '/picture">' + friend.name + '<input type="checkbox" name="facebookid[]" value="'+ friend.id +'" />' + '</div>';
            	
            	
             });                 // and display them at our holder element

            result_holder.innerHTML = results;


          
        } else {
        
       FB.login(function(response) { 
		   if (response.status === 'connected') {
    // Logged into your app and Facebook. - this should never be true
  } else if (response.status === 'not_authorized') {
    // The person is logged into Facebook, but not your app.
  } else {
    // The person is not logged into Facebook, so we're not sure if
    // they are logged into this app or not.
  }
}, {scope: 'user_friends'});
                	
        }
      
    });
}

</script>





<!--[if lt IE 7 ]>
<script src="//ajax.googleapis.com/ajax/libs/chrome-frame/1.0.3/CFInstall.min.js"></script>
<script>window.attachEvent('onload',function(){CFInstall.check({mode:'overlay'})})</script>
<![endif]-->
</body>
</html>
